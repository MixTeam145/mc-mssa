%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                                                                 %%%
%%%     Санкт-Петербургский государственный университет             %%%
%%%     факультет Прикладной математики — процессов управления      %%%
%%%                                                                 %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                                                                 %%%
%%%     Шаблон для подготовки статьи, набранной в пакете MikTeX,    %%%
%%%     для ежегодной конференции аспирантов и студентов            %%%
%%%                                                                 %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                                                                 %%%
%%%                        ОСНОВНЫЕ ПРАВИЛА                         %%%
%%%                                                                 %%%
%%%     1. при оформлении основных элементов статьи следует         %%%
%%%        использовать ниже описанные конструкции                  %%%
%%%     2. изменять стилевой файл ЗАПРЕЩАЕТСЯ                       %%%
%%%                                                                 %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                                                                 %%%
%%%     Дата последнего изменения: 10.02.2024                       %%%
%%%                                                                 %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[a4paper]{article}
\usepackage{pmstyle}
\usepackage{cite}

\usepackage{algorithm}
\usepackage{algpseudocode}

\include{letters_series_mathbb.tex}

\newtheorem{Algorithm}{Алгоритм}
\begin{document}
\hyphenation{СПбГУ}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                     УДК | АВТОР | НАЗВАНИЕ СТАТЬИ               %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% УДК для статьи берется со страницы http://teacode.com/online/udc/
\udk{УДК}

%%%   Если у статьи 1 автор
%%%     Фамилия~И.\:О.
%\author{Фамилия~И.\:О.}

%%%   Если у статьи 2 и более автора
%%%     Фамилия~И.\:О.
\author{Потешкин~Е.\:П.}

%%%%%%%%%   Название статьи
\title{}

\renewcommand{\thefootnote}{ }
{\footnotetext{{\it Потешкин Егор Павлович} -- студент, Санкт-Петербургский государственный университет; email: ..., тел.: ...}}

% если по ГРАНТУ
{\footnotetext{Работа выполнена при финансовой поддержке РФФИ, проект №}} % и/или СПбГУ, НИР № 0.00.000.0000}}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%                РЕКОМЕНДАЦИЯ К ПУБЛИКАЦИИ                %%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Рекомендация научного руководителя (необходимо для студентов и аспирантов).

%%%% БЕЗ рекомендации
%\norec{}

%%%% Рекомендовано профессором ...
%\recprof{Утешевым~А.\:Ю.}

%%%% Рекомендовано доцентом ...
%\recdotz{Михайловым~Е.\:П.}

%%%% Рекомендовано старшим преподавателем ...
%\recsp{Ереминым~А.\:С.}

%%%% Рекомендовано ассистентом ...
%\recassist{Ереминым~А.\:С.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\razdel{Введение}
Существует задача обнаружения сигнала в красном шуме с целью его дальнейшего выделения, например для анализа поведения глобального потепления~[TODO]. Метод Monte-Carlo SSA (MC-SSA)~[TODO] проверяет гипотезу о том, что во временном ряде присутствует сигнал, но самый распространенный вариант является радикальным. Поправка неточных критериев~[TODO] делает этот критерий точным. В данной работе рассмотрены две проблемы: выбор параметра $L$ для получения максимально возможной мощности и невозможность применения поправки на практике, если исходно критерий был слишком радикальным.

\razdel{Известные результаты}
Опишем уже известные результаты, чтобы в дальнейшем их использовать.
\podrazdel{SSA}
Пусть $\tX=(x_1,\ldots,x_N)$ -- временной ряд длины $N$. Зафиксируем $L$, $1<L<N$, называемый длиной окна. Построим матрицу $\bfX=[X_1:\ldots:X_K]$, состояшую из $K=N-L+1$ векторов вложения $X_i=(x_i,\ldots,x_{i+L-1})\in \mathbb R^L$.

Следующий шаг -- разложение в сумму матриц единичного ранга $\bfX=\sum_{i=1}^d \bfX_i$. В базовом SSA используется сингулярное разложение матрицы $\bfX$.

Далее компоненты полученного матричного разложения разумно группируются, и каждая
сгруппированная матрица преобразуется во временной ряд. Таким образом, результатом SSA является
разложение временного ряда.
\podrazdel{Toeplitz SSA}
Модификация базового SSA, Toeplitz SSA, использует вместо SVD тёплицево разложение матрицы $\bfX$:
\begin{equation*}
    \bfX=\sum_{i=1}^L\sigma_i P_iQ_i^\rmT = \bfX_1+\ldots \bfX_L,
\end{equation*}
где $\{P_i\}_{i=1}^L$ "--- собственные векторы матрицы $\widetilde \bfC$ с элементами
\begin{equation}\label{eq:toeplitz}
    \widetilde c_{ij} = \frac{1}{N - |i - j|}\sum_{m=1}^{N-|i-j|}x_mx_{m+|i-j|},1\leqslant i,j\leqslant L.
\end{equation}
Такое разложение имеет преимущество для стационарных временных рядов.
\podrazdel{Monte Carlo SSA}
Рассмотрим задачу поиска сигнала во временном ряде. Модель:
\[
    \tX=\tS + \boldsymbol\xi,
\]
где $\tS$ -- сигнал, $\boldsymbol\xi$ -- красный шум с параметрами $\varphi$ и $\delta$. Тогда нулевая гипотеза $H_0:\tS=0$ и альтернатива $H_1:\tS\ne0$.

Зафиксируем длину окна $L$ и обозначим траекторную матрицу ряда $\boldsymbol\xi$ как $\mathbf\Xi$. Рассмотрим вектор $W\in\mathbb R^L$ единичной длины, называемый проекционным вектором. Введем величину
\[
    p=\|\mathbf\Xi^\rmT W\|^2.
\]
Статистикой критерия является величина
\[
    \widehat p = \|\bfX^\rmT W\|^2.
\]
Если вектор $W$ -- синусоида с частотой $\omega$, то $\widehat{p}$ отражает вклад частоты $\omega$ в исходный ряд.

Далее строится доверительный интервал случайной величины $p$: в большинстве случаев распределение $p$ неизвестно, поэтому оно оценивается методом Монте-Карло.

Построив доверительный интервал, проверяется, лежит ли $\widehat p$ в нем. Если нет, гипотеза отвергается.

Стоит отметить, что данный критерий является несостоятельным против $H_1$, если частота $\omega$ сигнала $\tS$ неизвестна, что не редкость на практике.

Поэтому вместо одного вектора $W$ рассматривают набор $W_k$ и для каждого такого вектора строят доверительные интервалы. Без поправки на множественные сравнения данный вариант дает радикальный критерий. В работе~[TODO] был представлен модифицированный алгоритм построения критерия в случае множественного тестирования. 

Параметром MC-SSA является способ выбора векторов $W_k$. В данной работе в качестве векторов для проекции берутся собственные векторы матрицы $\widetilde \bfC$~\eqref{eq:toeplitz}. Такой способ выбора самый распространенный, поскольку, если есть значимые векторы, можно восстановить сигнал с помощью SSA на их основе. Но этот вариант, вообще говоря, дает радикальный критерий, поскольку $W_k$ зависят от ряда $\tX$, в котором мы ищем сигнал. С помощью поправки неточных критериев можно бороться с этой проблемой.
\podrazdel{Поправка неточных критериев}
Данный алгоритм позволяет преобразовывать радикальные и консервативные статистические критерии в точные.

Зафиксируем нулевую гипотезу $H_0$, уровень значимости $\alpha^*$, количество выборок $M$ для оценки $\alpha_I(\alpha)$ и их объем $N$.

Сначала моделируется $M$ выборок объема $N$ при верной $H_0$. Затем по моделированным данным строится зависимость ошибки первого рода от уровня значимости $\alpha_I(\alpha)$. Результатом работы алгоритма является формальный уровень значимости $\widetilde{\alpha}^*=\alpha_I^{-1}(\alpha^*)$. Критерий с таким уровнем значимости является асимптотически точным при $M\to\infty$.

\podrazdel{ROC-кривая}
ROC-кривая -- это кривая, задаваемая параметрически:
\[
		\begin{cases}
			x=\alpha_I(\alpha) \\
			y=\beta(\alpha)
		\end{cases},\quad \alpha\in[0,1],
\]
где $\alpha_I(\alpha)$ "--- функция зависимости ошибки первого рода $\alpha_I$ от уровня значимости $\alpha$, $\beta(\alpha)$ "--- функция зависимости мощности $\beta$ от уровня значимости $\alpha$.

С помощью ROC-кривых можно сравнивать по мощности неточные критерии. Отметим, что для точного (в частности, поправленного) критерия ROC-кривая совпадает с графиком мощности, так как $\alpha_I(\alpha)=\alpha$.

\razdel{Зависимость радикальности и мощности MC-SSA от параметра $L$}
Поскольку критерий MC-SSA в самом распространенном варианте радикальный, существует проблема выбора такой длины окна $L$, чтобы получить наилучший по мощности критерий, при этом не слишком радикальный, чтобы можно было применить поправку. Рассмотрим пример: пусть дана модель
\[
    \tX=\tS+\boldsymbol{\xi},
\]
где $\tS=\{A\cos(2\pi\omega n)\}_{n=1}^N$ -- сигнал с $\omega = 0.075$, а $\boldsymbol{\xi}$ -- красный шум с параметрами $\varphi=0.7$ и $\delta=1$. Длина ряда равна $N=100$. Рассмотрим следующую нулевую гипотезу с альтернативой: $H_0:A=0$, $H_1:A=1$.
\Figure{0.5\textwidth}{./img/alphaI_phi7.pdf}{Ошибка I рода\label{alphaI_phi7} ($N=100$, $\varphi=0.7$)}
\Figure{0.5\textwidth}{./img/roc_phi7.pdf}{ROC-кривая\label{roc_phi7} ($N=100$, $\varphi=0.7$)}

По графику ошибкок первого рода на рис.~\ref{alphaI_phi7} видно, что чем больше $L$, тем более радикальным становится критерий. На рис.~\ref{roc_phi7} изображены ROC-кривые критериев, наибольшую мощность дает критерий с $L=90$. На этом примере видно, что чем сильнее радикальность критерия, тем более мощным он является после поправки.

Посмотрим на другой пример. Рассмотрим теперь красный шум с параметрами $\varphi=0.3$ и $\delta=1$ и увеличим длину ряда до $N=200$. Для удобства сравнения ROC-кривых, уменьшим амплитуду сигнала до $A=0.7$ при верной $H_1$.
\Figure{0.5\textwidth}{./img/alphaI_phi3.pdf}{Ошибка I рода\label{alphaI_phi3} ($N=200$, $\varphi=0.3$)}
\Figure{0.5\textwidth}{./img/roc_phi3.pdf}{ROC-кривая\label{roc_phi3} ($N=200$, $\varphi=0.3$)}

ROC-кривую для этого примера на рис.~\ref{roc_phi3} не удалось построить полностью для $L=190$ из-за сильной радикальности, это видно на рис.~\ref{alphaI_phi3}.

Для многочисленных примеров было получено, что с увеличением $L$ радикальность критерия сильно растет, а мощность, в целом, растет, но несильно. Это верно для разных длин ряда, для разных параметров красного шума и сигнала.

\razdel{Алгоритм поиска оптимального $L$}
В предыдущем примере из-за слишком сильной радикальности невозможно применить поправку для $L=190$. Поэтому нужно найти такое $L$, чтобы ошибка первого рода была не слишком большой.

Учитывая, что с увеличением $L$ растет радикальность исходного критерия и мощность поправленного, предлагаем алгоритм поиска оптимальной длины окна, для которой ошибка I рода критерия не превосходит порогового значения. 
\podrazdel{Вход алгоритма}
Временной ряд $\tX$, уровень значимости $\alpha^*$, порог ошибки первого рода $\hat\alpha_I$ при уровне значимости $\alpha^*$, интервал $[L_{\text{left}}, L_{\text{right}}]$ поиска оптимального $L$, желаемая точность $\varepsilon$.
\podrazdel{Выход алгоритма}
Оптимальная длина окна $L_\text{optim}$: 
\[
    L_\text{optim}=\max\left\{L\in[L_\text{left}, L_{\text{right}}]:|\alpha_I^{(L)} - \hat{\alpha_I}|<\varepsilon\right\}.
\]
\podrazdel{Алгоритм}
\begin{enumerate}
    \item Вычислить $\alpha_I^{(L_\text{left})}$ и $\alpha_I^{(L_\text{right})}$. Если $\alpha_I^{(L_\text{right})} \leqslant \hat\alpha_I$, завершить алгоритм с $L_\text{optim}=L_\text{right}$. Иначе, если $|\alpha_I^{(L_\text{left})} - \hat{\alpha_I}| < \varepsilon$, завершить алгоритм с $L_\text{optim}=L_\text{left}$. Иначе, если $\alpha_I^{(L_\text{left})} > \hat{\alpha_I}$, оптимальной длины окна на этом интервале нет, завершить алгоритм.
    \item Вычислить $\alpha_I^{(L_\text{mid})}$, где $L_\text{mid}=\lfloor(L_\text{left}+L_\text{right})/2\rfloor$. Если \\$|\alpha_I^{(L_\text{mid})} - \hat\alpha_I| < \varepsilon$, завершить алгшоритм с $L_\text{optim}=L_\text{mid}$. Иначе, если $\alpha_I^{(L_\text{mid})} < \hat{\alpha_I}$, $L_\text{left}=L_\text{mid}$. Если $\alpha_I^{(L_\text{mid})} > \hat{\alpha_I}$, $L_\text{right}=L_\text{mid}$.
    \item Если $|\alpha_I^{(L_\text{mid})} - \hat\alpha_I| \geqslant \varepsilon$, повторить пункт 2 до тех пор, пока $L_\text{left} < L_\text{right} - 5$.
    \item Если $L_\text{left} \geqslant L_\text{right} - 5$, завершить алгоритм с $L_\text{optim}=L_\text{left}$.
\end{enumerate}

\razdel{Проверка работы алгоритма}
\Figure{0.5\textwidth}{./img/roc_phi3_alg.pdf}{ROC-кривая\label{roc_phi3_alg} ($N=200$, $\varphi=0.3$), $L_\text{optim}=145$}
Проверим работу алгоритма на втором примере из раздела 3. Поиск $L_\text{optim}$ велся на интервале $[100, 190]$ со следующими параметрами: $\alpha^*=0.05$, $\hat\alpha_I = 0.5$, $\varepsilon=0.05$. Результат алгоритма: $L_\text{optim}=145$ с $\alpha_I^{(L_\text{optim})}=0.494$.
По рис.~\ref{roc_phi3_alg} изображены ROC-кривые критериев с добавлением $L_\text{optim}$. Как видно, ROC-кривую для $L_\text{optim}$ уже удалось построить и такая длина окна действительно оптимальна.
%%%% Список литературы должен быть оформлен по следующему образцу:
\begin{thebibliography}{40}

\end{thebibliography}
\end{document}
