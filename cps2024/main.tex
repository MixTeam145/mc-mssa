%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                                                                 %%%
%%%     Санкт-Петербургский государственный университет             %%%
%%%     факультет Прикладной математики — процессов управления      %%%
%%%                                                                 %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                                                                 %%%
%%%     Шаблон для подготовки статьи, набранной в пакете MikTeX,    %%%
%%%     для ежегодной конференции аспирантов и студентов            %%%
%%%                                                                 %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                                                                 %%%
%%%                        ОСНОВНЫЕ ПРАВИЛА                         %%%
%%%                                                                 %%%
%%%     1. при оформлении основных элементов статьи следует         %%%
%%%        использовать ниже описанные конструкции                  %%%
%%%     2. изменять стилевой файл ЗАПРЕЩАЕТСЯ                       %%%
%%%                                                                 %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                                                                 %%%
%%%     Дата последнего изменения: 10.02.2024                       %%%
%%%                                                                 %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass[a4paper]{article}
\usepackage{pmstyle}
\usepackage{cite}


%new calligraphic font for subspaces
\usepackage{euscript}
\newcommand{\cA}{\EuScript{A}}
\newcommand{\cB}{\EuScript{B}}
\newcommand{\cC}{\EuScript{C}}
\newcommand{\cD}{\EuScript{D}}
\newcommand{\cE}{\EuScript{E}}
\newcommand{\cF}{\EuScript{F}}
\newcommand{\cG}{\EuScript{G}}
\newcommand{\cH}{\EuScript{H}}
\newcommand{\cI}{\EuScript{I}}
\newcommand{\cJ}{\EuScript{J}}
\newcommand{\cK}{\EuScript{K}}
\newcommand{\cL}{\EuScript{L}}
\newcommand{\cM}{\EuScript{M}}
\newcommand{\cN}{\EuScript{N}}
\newcommand{\cO}{\EuScript{O}}
\newcommand{\cP}{\EuScript{P}}
\newcommand{\cQ}{\EuScript{Q}}
\newcommand{\cR}{\EuScript{R}}
\newcommand{\cS}{\EuScript{S}}
\newcommand{\cT}{\EuScript{T}}
\newcommand{\cU}{\EuScript{U}}
\newcommand{\cV}{\EuScript{V}}
\newcommand{\cW}{\EuScript{W}}
\newcommand{\cX}{\EuScript{X}}
\newcommand{\cY}{\EuScript{Y}}
\newcommand{\cZ}{\EuScript{Z}}

%font for text indices like transposition X^\mathrm{T}
\newcommand{\rmA}{\mathrm{A}}
\newcommand{\rmB}{\mathrm{B}}
\newcommand{\rmC}{\mathrm{C}}
\newcommand{\rmD}{\mathrm{D}}
\newcommand{\rmE}{\mathrm{E}}
\newcommand{\rmF}{\mathrm{F}}
\newcommand{\rmG}{\mathrm{G}}
\newcommand{\rmH}{\mathrm{H}}
\newcommand{\rmI}{\mathrm{I}}
\newcommand{\rmJ}{\mathrm{J}}
\newcommand{\rmK}{\mathrm{K}}
\newcommand{\rmL}{\mathrm{L}}
\newcommand{\rmM}{\mathrm{M}}
\newcommand{\rmN}{\mathrm{N}}
\newcommand{\rmO}{\mathrm{O}}
\newcommand{\rmP}{\mathrm{P}}
\newcommand{\rmQ}{\mathrm{Q}}
\newcommand{\rmR}{\mathrm{R}}
\newcommand{\rmS}{\mathrm{S}}
\newcommand{\rmT}{\mathrm{T}}
\newcommand{\rmU}{\mathrm{U}}
\newcommand{\rmV}{\mathrm{V}}
\newcommand{\rmW}{\mathrm{W}}
\newcommand{\rmX}{\mathrm{X}}
\newcommand{\rmY}{\mathrm{Y}}
\newcommand{\rmZ}{\mathrm{Z}}

%tt font for time series
\newcommand{\tA}{\mathsf{A}}
\newcommand{\tB}{\mathsf{B}}
\newcommand{\tC}{\mathsf{C}}
\newcommand{\tD}{\mathsf{D}}
\newcommand{\tE}{\mathsf{E}}
\newcommand{\tF}{\mathsf{F}}
\newcommand{\tG}{\mathsf{G}}
\newcommand{\tH}{\mathsf{H}}
\newcommand{\tI}{\mathsf{I}}
\newcommand{\tJ}{\mathsf{J}}
\newcommand{\tK}{\mathsf{K}}
\newcommand{\tL}{\mathsf{L}}
\newcommand{\tM}{\mathsf{M}}
\newcommand{\tN}{\mathsf{N}}
\newcommand{\tO}{\mathsf{O}}
\newcommand{\tP}{\mathsf{P}}
\newcommand{\tQ}{\mathsf{Q}}
\newcommand{\tR}{\mathsf{R}}
\newcommand{\tS}{\mathsf{S}}
\newcommand{\tT}{\mathsf{T}}
\newcommand{\tU}{\mathsf{U}}
\newcommand{\tV}{\mathsf{V}}
\newcommand{\tW}{\mathsf{W}}
\newcommand{\tX}{\mathsf{X}}
\newcommand{\tY}{\mathsf{Y}}
\newcommand{\tZ}{\mathsf{Z}}

%bf font for matrices
\newcommand{\bfA}{\mathbf{A}}
\newcommand{\bfB}{\mathbf{B}}
\newcommand{\bfC}{\mathbf{C}}
\newcommand{\bfD}{\mathbf{D}}
\newcommand{\bfE}{\mathbf{E}}
\newcommand{\bfF}{\mathbf{F}}
\newcommand{\bfG}{\mathbf{G}}
\newcommand{\bfH}{\mathbf{H}}
\newcommand{\bfI}{\mathbf{I}}
\newcommand{\bfJ}{\mathbf{J}}
\newcommand{\bfK}{\mathbf{K}}
\newcommand{\bfL}{\mathbf{L}}
\newcommand{\bfM}{\mathbf{M}}
\newcommand{\bfN}{\mathbf{N}}
\newcommand{\bfO}{\mathbf{O}}
\newcommand{\bfP}{\mathbf{P}}
\newcommand{\bfQ}{\mathbf{Q}}
\newcommand{\bfR}{\mathbf{R}}
\newcommand{\bfS}{\mathbf{S}}
\newcommand{\bfT}{\mathbf{T}}
\newcommand{\bfU}{\mathbf{U}}
\newcommand{\bfV}{\mathbf{V}}
\newcommand{\bfW}{\mathbf{W}}
\newcommand{\bfX}{\mathbf{X}}
\newcommand{\bfY}{\mathbf{Y}}
\newcommand{\bfZ}{\mathbf{Z}}

%bb font for standard spaces and expectation
\newcommand{\bbA}{\mathbb{A}}
\newcommand{\bbB}{\mathbb{B}}
\newcommand{\bbC}{\mathbb{C}}
\newcommand{\bbD}{\mathbb{D}}
\newcommand{\bbE}{\mathbb{E}}
\newcommand{\bbF}{\mathbb{F}}
\newcommand{\bbG}{\mathbb{G}}
\newcommand{\bbH}{\mathbb{H}}
\newcommand{\bbI}{\mathbb{I}}
\newcommand{\bbJ}{\mathbb{J}}
\newcommand{\bbK}{\mathbb{K}}
\newcommand{\bbL}{\mathbb{L}}
\newcommand{\bbM}{\mathbb{M}}
\newcommand{\bbN}{\mathbb{N}}
\newcommand{\bbO}{\mathbb{O}}
\newcommand{\bbP}{\mathbb{P}}
\newcommand{\bbQ}{\mathbb{Q}}
\newcommand{\bbR}{\mathbb{R}}
\newcommand{\bbS}{\mathbb{S}}
\newcommand{\bbT}{\mathbb{T}}
\newcommand{\bbU}{\mathbb{U}}
\newcommand{\bbV}{\mathbb{V}}
\newcommand{\bbW}{\mathbb{W}}
\newcommand{\bbX}{\mathbb{X}}
\newcommand{\bbY}{\mathbb{Y}}
\newcommand{\bbZ}{\mathbb{Z}}

%got font for any case
\newcommand{\gA}{\mathfrak{A}}
\newcommand{\gB}{\mathfrak{B}}
\newcommand{\gC}{\mathfrak{C}}
\newcommand{\gD}{\mathfrak{D}}
\newcommand{\gE}{\mathfrak{E}}
\newcommand{\gF}{\mathfrak{F}}
\newcommand{\gG}{\mathfrak{G}}
\newcommand{\gH}{\mathfrak{H}}
\newcommand{\gI}{\mathfrak{I}}
\newcommand{\gJ}{\mathfrak{J}}
\newcommand{\gK}{\mathfrak{K}}
\newcommand{\gL}{\mathfrak{L}}
\newcommand{\gM}{\mathfrak{M}}
\newcommand{\gN}{\mathfrak{N}}
\newcommand{\gO}{\mathfrak{O}}
\newcommand{\gP}{\mathfrak{P}}
\newcommand{\gQ}{\mathfrak{Q}}
\newcommand{\gR}{\mathfrak{R}}
\newcommand{\gS}{\mathfrak{S}}
\newcommand{\gT}{\mathfrak{T}}
\newcommand{\gU}{\mathfrak{U}}
\newcommand{\gV}{\mathfrak{V}}
\newcommand{\gW}{\mathfrak{W}}
\newcommand{\gX}{\mathfrak{X}}
\newcommand{\gY}{\mathfrak{Y}}
\newcommand{\gZ}{\mathfrak{Z}}

%old calligraphic font
\newcommand{\calA}{\mathcal{A}}
\newcommand{\calB}{\mathcal{B}}
\newcommand{\calC}{\mathcal{C}}
\newcommand{\calD}{\mathcal{D}}
\newcommand{\calE}{\mathcal{E}}
\newcommand{\calF}{\mathcal{F}}
\newcommand{\calG}{\mathcal{G}}
\newcommand{\calH}{\mathcal{H}}
\newcommand{\calI}{\mathcal{I}}
\newcommand{\calJ}{\mathcal{J}}
\newcommand{\calK}{\mathcal{K}}
\newcommand{\calL}{\mathcal{L}}
\newcommand{\calM}{\mathcal{M}}
\newcommand{\calN}{\mathcal{N}}
\newcommand{\calO}{\mathcal{O}}
\newcommand{\calP}{\mathcal{P}}
\newcommand{\calQ}{\mathcal{Q}}
\newcommand{\calR}{\mathcal{R}}
\newcommand{\calS}{\mathcal{S}}
\newcommand{\calT}{\mathcal{T}}
\newcommand{\calU}{\mathcal{U}}
\newcommand{\calV}{\mathcal{V}}
\newcommand{\calW}{\mathcal{W}}
\newcommand{\calX}{\mathcal{X}}
\newcommand{\calY}{\mathcal{Y}}
\newcommand{\calZ}{\mathcal{Z}}


\begin{document}
\hyphenation{СПбГУ}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%                     УДК | АВТОР | НАЗВАНИЕ СТАТЬИ               %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% УДК для статьи берется со страницы http://teacode.com/online/udc/
\udk{УДК 519.254, 519.688}

%%%   Если у статьи 1 автор
%%%     Фамилия~И.\:О.
%\author{Фамилия~И.\:О.}

%%%   Если у статьи 2 и более автора
%%%     Фамилия~И.\:О.
\author{Потешкин~Е.\:П.}

%%%%%%%%%   Название статьи
\title{Выбор параметров в методе Монте-Карло SSA}

\renewcommand{\thefootnote}{ }
{\footnotetext{{\it Потешкин Егор Павлович} -- студент, Санкт-Петербургский государственный университет; email: egor.poteshkin@yandex.ru, тел.: +7(921)560-32-02}}

% если по ГРАНТУ
%{\footnotetext{Работа выполнена при финансовой поддержке РНФ, проект № 23-21-00222}} % и/или СПбГУ, НИР № 0.00.000.0000}}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%                РЕКОМЕНДАЦИЯ К ПУБЛИКАЦИИ                %%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% Рекомендация научного руководителя (необходимо для студентов и аспирантов).

%%%% БЕЗ рекомендации
%\norec{}

%%%% Рекомендовано профессором ...
%\recprof{Утешевым~А.\:Ю.}

%%%% Рекомендовано доцентом ...
\recdotz{Голяндиной Н.Э.}

%%%% Рекомендовано старшим преподавателем ...
%\recsp{Ереминым~А.\:С.}

%%%% Рекомендовано ассистентом ...
%\recassist{Ереминым~А.\:С.}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\razdel{Введение}
Обнаружения сигнала в красном шуме (красным шумом называется процесс авторегрессии первого порядка с положительным коэффициентом) с целью его дальнейшего выделения является важной задачей, например, для анализа поведения течения Эль-Ниньо~\cite{Jevrejeva2004} или глобального потепления~\cite{cps23}. Одним из методов, используемым для этой цели, является метод Monte-Carlo SSA (MC-SSA)~\cite{AllenSmith96}, который проверяет гипотезу о том, что отсутствует сигнал, а в случае если она отвергается, позволяет приближенно выделить этот сигнал. При использовании метода MC-SSA возникают следующие проблемы. Используемый на практике вариант критерия в методе MC-SSA является радикальным, поэтому для его использования необходимы поправки. В~\cite{Golyandina2023} предлагается поправка на множественное тестирование, частично исправляющая радикальность. Однако применяемая на практике модификация критерия все еще остается радикальной. Эту радикальность сложно исправить теоретически, поэтому используется метод эмпирической поправки критерия, основанный на оцененных ошибках первого рода в зависимости от уровня значимости, см., например,~\cite{cps22}, где этот подход используется в контексте метода MC-SSA.

Используемый в той же работе~\cite{cps22} подход через построение ROC-кривых позволяет сравнивать критерии по мощности. Соответственно возникает вопрос о выборе параметра метода MC-SSA, называемого длиной окна, дающего оптимальную мощность. Ответу на этот вопрос мешает то, что если исходно критерий сильно радикальный, то поправку, исправляющую радикальность, очень трудоемко или даже невозможно сделать.

Данная статья посвящена построению подхода к поиску длины окна, при которой критерий наиболее мощный среди ограниченно радикальных критериев.

В разделе 2 приведены известные результаты. В разделе 3 приведены результаты численного исследования зависимости ошибки первого рода и мощности от длины окна. На основе этих результатов в разделе 4 предложен подход к поиску длины окна.

\razdel{Известные результаты}
В этом разделе введем нужные обозначения и приведем известные результаты, чтобы в дальнейшем их использовать.
\podrazdel{SSA~\cite{ssa2001}}
Пусть $\tX=(x_1,\ldots,x_N)$, $x_i\in \mathbb{R}$, -- временной ряд длины $N$. Зафиксируем параметр $L$, $1<L<N$, называемый длиной окна. Построим траекторную матрицу $\bfX=[X_1:\ldots:X_K]$, состоящую из $K=N-L+1$ векторов вложения $X_i=(x_i,\ldots,x_{i+L-1})^{\rmT}\in \mathbb R^L$.

Следующий шаг -- разложение в сумму матриц единичного ранга $\bfX=\sum_{i=1}^d \bfX_i$. В базовом SSA используется сингулярное разложение матрицы ${X}$.

Далее компоненты полученного матричного разложения разумно группируются, и каждая
сгруппированная матрица преобразуется во временной ряд. Таким образом, результатом SSA является
разложение временного ряда.
\podrazdel{Toeplitz SSA~\cite{ssa2001}}
Модификация базового SSA, Toeplitz SSA, использует вместо сингулярного разложения разложение матрицы $\bfX$, основанное на собственных векторах  $\{P_i\}_{i=1}^L$ тёплицевой матрицы $\bfC$ с элементами
\begin{equation}\label{eq:toeplitz}
    c_{ij} = \frac{1}{N - |i - j|}\sum_{m=1}^{N-|i-j|}x_mx_{m+|i-j|},\quad 1\leqslant i,j\leqslant L.
\end{equation}
Тогда
\begin{equation*}
    \bfX=\sum_{i=1}^L\sigma_i P_iQ_i^{T} = \bfX_1+\ldots \bfX_L,
\end{equation*}
где $Q_i = \bfX^\rmT P_i/\sigma_i$, $\sigma_i= \|\bfX^{\rmT} P_i\|$.
Такое разложение представляется более естественным для стационарных временных рядов с нулевым средним, когда $\bfC$ является оценкой автоковариационной матрицы.

\podrazdel{Monte Carlo SSA~\cite{AllenSmith96}}
Рассмотрим задачу поиска сигнала во временном ряде. Модель временного ряда имеет вид
\[
    \tX=\tS + \boldsymbol\xi,
\]
где $\tS$ -- сигнал, $\boldsymbol\xi$ -- красный шум с параметрами $\varphi$ и $\delta$. Тогда нулевая гипотеза $H_0:\tS=0$ и альтернатива $H_1:\tS\ne0$.

Зафиксируем длину окна $L$ и обозначим траекторную матрицу ряда $\boldsymbol\xi$ как $\mathbf\Xi$. Рассмотрим вектор $W\in \mathbb R^L$ единичной длины, называемый проекционным вектором. Введем величину
\[
    p=\|\mathbf\Xi^{\rmT} W\|^2.
\]
Статистикой критерия является величина
\[
    \widehat p = \|{\bfX}^{\rmT} W\|^2.
\]
Распределение статистики критерия оценивается с помощью моделирования согласно нулевой гипотезе, отсюда и название метода.

Если вектор $W$ -- синусоида с частотой $\omega$, то $\widehat{p}$ отражает вклад частоты $\omega$ в исходный ряд. Так как частота ожидаемого сигнала неизвестна, то необходимо рассматривать несколько векторов $W_k$, $k=1,\ldots,H$. Решение возникающей при этом проблемы множественного тестирования рассматривается в~\cite{Golyandina2023}.
Гипотеза об отсутствии сигнала отвергается, если хотя бы для одного вектора $W=W_k$ значение $\widehat p$ оказывается значимым. %Если связать каждый вектор с частотой, то

%Далее строится доверительный интервал случайной величины $p$: в большинстве случаев распределение $p$ неизвестно, поэтому оно оценивается методом Монте-Карло.

%Построив доверительный интервал, проверяется, лежит ли $\widehat p$ в нем. Если нет, гипотеза отвергается.

%Стоит отметить, что данный критерий является несостоятельным против $H_1$, если частота $\omega$ сигнала $\tS$ неизвестна, что не редкость на практике.

%Поэтому вместо одного вектора $W$ рассматривают набор $W_k$ и для каждого такого вектора строят доверительные интервалы. Без поправки на множественные сравнения данный вариант дает радикальный критерий. В работе~[TODO] был представлен модифицированный алгоритм построения критерия в случае множественного тестирования.

Еще одним параметром MC-SSA является способ выбора векторов $W_k$. В данной работе в качестве векторов для проекции берутся собственные векторы матрицы $\bfC$, определенной в~\eqref{eq:toeplitz}. Такой способ выбора самый распространенный, поскольку, если есть значимые векторы, можно восстановить сигнал с помощью SSA на их основе. Но этот вариант, вообще говоря, дает радикальный критерий, поскольку $W_k$ зависят от ряда $\tX$, в котором мы ищем сигнал. С помощью эмпирической поправки неточных критериев можно бороться с этой проблемой. Опишем ее в следующем разделе.
\podrazdel{Поправка неточных критериев}
Данный алгоритм позволяет преобразовывать радикальные и консервативные статистические критерии в точные.

Зафиксируем нулевую гипотезу $H_0$, уровень значимости $\alpha^*$, количество выборок $M$ для оценки $\alpha_I(\alpha)$ и их объем $N$ (в случае временных рядов $N$ -- длина ряда).

Сначала моделируется $M$ выборок объема $N$ при верной $H_0$. Затем по моделированным данным строится зависимость ошибки первого рода от уровня значимости $\alpha_I(\alpha)$. Результатом \pagebreak работы алгоритма является формальный уровень значимости $\widetilde{\alpha}^*=\alpha_I^{-1}(\alpha^*)$. Критерий с таким уровнем значимости является асимптотически точным при $M\to\infty$.

Заметим, что если критерий сильно радикальный, то функция $\alpha_I(\alpha)$ имеет большую производную в нуле, что существенно затрудняет оценку $\alpha_I^{-1}(\alpha^*)$.

\podrazdel{ROC-кривая}
ROC-кривая -- это кривая, задаваемая параметрически:
\[
		\begin{cases}
			x=\alpha_I(\alpha) \\
			y=\beta(\alpha)
		\end{cases},\quad \alpha\in[0,1],
\]
где $\alpha_I(\alpha)$ -- функция зависимости ошибки первого рода $\alpha_I$ от уровня значимости $\alpha$, $\beta(\alpha)$ -- функция зависимости мощности $\beta$ от уровня значимости $\alpha$.

С помощью ROC-кривых можно сравнивать по потенциальной мощности неточные критерии. Отметим, что для точного (в частности, поправленного) критерия ROC-кривая совпадает с графиком мощности, так как $\alpha_I(\alpha)=\alpha$.

\razdel{Зависимость радикальности и мощности MC-SSA от параметра $L$}\label{sect:dependence}
Поскольку рассматриваемый вариант критерия MC-SSA является радикальным, существует проблема выбора такой длины окна $L$, которая дает максимально мощный критерий, но при этом не слишком радикальный, чтобы можно было применить поправку. Однако, в зависимости от длины ряда $N$ и параметров красного шума $\boldsymbol{\xi}$ наблюдаются разные зависимости мощности от $L$.

Рассмотрим несколько примеров. Пусть дана модель
\[
    \tX=\tS+{\boldsymbol\xi},
\]
где $\tS=\{A\cos(2\pi\omega n)\}_{n=1}^N$, а ${\boldsymbol\xi}$ -- красный шум с параметрами $\varphi$ и $\delta=1$. Рассмотрим следующие нулевую гипотезу и альтернативу: $H_0:A=0$, $H_1:A\ne0$. В работе~\cite{cps22} было показано, что оценка параметров модели почти не искажает критерий после применения алгоритма поправки, поэтому будем предполагать, что параметры красного шума нам известны. В первых трех примерах рассмотрим частоту сигнала $\omega = 0.075$.
\Example~$\varphi=0.7$, $N=100$.
\Figure{0.7\textwidth}{./images/alphaI_phi7_N100.eps}{Ошибка I рода\label{alphaI_phi7_N100} ($\varphi=0.7$, $N=100$)}
\Figure{0.7\textwidth}{./images/roc_phi7_N100.eps}{ROC-кривая\label{roc_phi7_N100} ($\varphi=0.7$, $N=100$, $\omega=0.075$)}

По графику ошибок первого рода на рис.~\ref{alphaI_phi7_N100} видно, что чем больше $L$, тем более радикальным становится критерий. На рис.~\ref{roc_phi7_N100} \pagebreak изображены ROC-кривые критериев, наибольшую мощность дает критерий с $L=90$. На этом примере видно, что самым мощным является самый радикальный критерий. 

\Example~$\varphi=0.3$, $N=100$.
\Figure{0.7\textwidth}{./images/alphaI_phi3_N100.eps}{Ошибка I рода ($\varphi=0.3$, $N=100$)\label{alphaI_phi3_N100}}
\Figure{0.7\textwidth}{./images/roc_phi3_N100.eps}{ROC-кривая ($\varphi=0.3$, $N=100$, $\omega=0.075$)\label{roc_phi3_N100}}
На рис.~\ref{alphaI_phi3_N100} изображен график ошибок первого рода. По нему видно, что, как и в примере 1, чем больше $L$, тем больше радикальность критерия. Если взглянуть на ROC-кривые на рис.~\ref{roc_phi3_N100}, то видно, что с уменьшением параметра $\varphi$ уменьшается разброс мощности критериев после поправки в зависимости от длины окна. Лучшей из рассмотренных в этом случае является $L=10$, хотя разница с $L=50$ совсем небольшая, а для $L=90$ для небольших ошибок I рода поправку сделать не удалось из-за радикальности.

\Example~$N=400$.
Теперь увеличим длину ряда до $N=400$ и посмотрим на ROC-кривые для примеров 1 и 2.
\Figure{0.7\textwidth}{./images/roc_phi7_N400.eps}{ROC-кривая ($\varphi=0.7$, $N=400$, $\omega=0.075$)\label{roc_phi7_N400}}
\Figure{0.7\textwidth}{./images/roc_phi3_N400.eps}{ROC-кривая ($\varphi=0.3$, $N=400$, $\omega=0.075$)\label{roc_phi3_N400}}
На рис.~\ref{roc_phi7_N400} и рис.~\ref{roc_phi3_N400} видим, что для обоих примеров с увеличением длины ряда уменьшается различие в мощности после поправки в зависимости от длины окна.

\Example~В условиях примера~1 с $N=100$ и $\varphi=0.7$ рассмотрим разные частоты $\omega$ сигнала $\tS$ и зависимость упорядоченности критериев по мощности от $L$. 
\Figure{0.7\textwidth}{./images/roc_omega0175.eps}{ROC-кривая ($\varphi=0.7$, $N=100$, $\omega=0.175$)\label{roc_omega0125}}
\Figure{0.7\textwidth}{./images/roc_omega0025.eps}{ROC-кривая ($\varphi=0.7$, $N=100$, $\omega=0.025$)\label{roc_omega005}}
На рис.~\ref{roc_omega0125} и рис.~\ref{roc_omega005} изображены ROC-кривые критериев при разных альтернативах. Видно, что, упорядоченность $L$ нарушается при маленьких частотах сигнала. Если упорядочить рисунки рис.~\ref{roc_omega0125}, рис.~\ref{roc_phi7_N100} и рис.~\ref{roc_omega005} по частоте $\omega$, то видна динамика по соотношению ROC-кривых для $L=10$ и $L=50$.

\razdel{Рекомендации по выбору длины окна}
Численные эксперименты показали, что длина окна $L$, дающая максимальную мощность критерия после поправки, зависит от параметров шума, длины ряда и, главное, частоты сигнала в альтернативной гипотезе. Поэтому рекомендации можно дать только в общем виде.
\begin{enumerate}
    \item Первый вариант --- использовать поправленный критерий MC-SSA с $L=10$. Плюсы: нетрудозатратно, а также критерий не является сильно радикальным (в рассмотренных примерах он близок к точному). Минус: такой выбор $L$ может являться не оптимальным, т.е. возможна некоторая потеря в мощности.
    \item В поведении оптимальной по мощности длины окна $L$ в зависимости от параметров ряда наблюдается некоторая регулярность. Поэтому можно было бы построить зависимость оптимальной длины окна от параметров ряда с помощью численного моделирования, оценив параметры красного шума. Однако, так как было показано, что упорядоченность критериев по мощности зависит от частоты сигнала в альтернативе, эта рекомендация имеет практический смысл, только если есть дополнительная информация о диапазоне возможных частот в альтернативе.
\end{enumerate}


\razdel{Заключение}
В работе была проведено исследование для выработки подхода к выбору параметра <<длина окна>> в методе MC-SSA, позволяющем обнаруживать сигнал в красном шуме. Оказалось, что из-за того, что возможная частота сигнала, вообще говоря, неизвестна, использование численного моделирования не является решением задачи выбора оптимальной длины окна. В целом, численное моделирование позволяет дать рекомендации по выбору $L$ при уточнении диапазона возможный частоты сигнала. В любом случае, численное моделирование является весьма трудоемким, поэтому, вполне возможно, что наиболее разумной альтернативой является выбор маленькой длины окна (например, $L=10$). Как показано на примерах, MC-SSA с такой длиной окна не всегда дает максимальную мощность, однако, обладает небольшой трудоемкость и малой радикальностью.
%%%% Список литературы должен быть оформлен по следующему образцу:
\begin{thebibliography}{40}
    \bibitem{Jevrejeva2004} Jevrejeva~S., Moore~J.C., Grinsted~A. Oceanic and atmospheric transport of multiyear El Ni\~{n}o–Southern Oscillation (ENSO) signatures to the polar regions // Geophysical Research Letters. 2004. Vol.~31. L24210.
    \bibitem{cps23} Селиверстова~К.\:А. Применение статистических методов для оценки глобального потепления // Процессы управления и устойчивость. 2023. T. 10. №~1. С.~195--199.
    \bibitem{AllenSmith96} Allen~M., Smith~L. Monte Carlo SSA: detecting irregular oscillations in the presence of coloured noise // Journal of Climate. 1996. Vol.~9. P.~3373–-3404.
    \bibitem{Golyandina2023} Golyandina~N. Detection of signals by Monte Carlo singular spectrum analysis: multiple testing // Statistics and Its Interface. 2023. Vol.~16. №~1. P.~147--157.
    \bibitem{cps22} Ларин~Е.\:С. Применимость исправления статистических критериев на примере задачи обнаружения сигнала во временных рядах // Процессы управления и устойчивость. 2022. T. 9. №~1. С.~267--271.
    \bibitem{ssa2001} Golyandina~N., Nekrutkin~V., Zhigljavsky~A. Analysis of Time Series Structure: SSA and Related Techniques. Chapman and Hall/CRC, 2001.
\end{thebibliography}
\end{document}
